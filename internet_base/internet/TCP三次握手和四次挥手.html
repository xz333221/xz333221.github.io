<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="https://my-assets.pek3b.qingstor.com/images/logo11.png"><title>TCP三次握手和四次挥手 | 流光的blog</title><meta name="description" content="我的个人网站">
    <link rel="modulepreload" href="/assets/app.a46b8e12.js"><link rel="modulepreload" href="/assets/TCP三次握手和四次挥手.html.154e2cc5.js"><link rel="modulepreload" href="/assets/TCP三次握手和四次挥手.html.66f9b2bc.js">
    <link rel="stylesheet" href="/assets/style.39d5bbe5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="https://my-assets.pek3b.qingstor.com/images/logo11.png" alt="流光的blog"><span class="site-name can-hide">流光的blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/front_road/road/前端路线.md" class="" aria-label="前端路线"><!--[--><!--]--> 前端路线 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/internet_base/internet/TCP三次握手和四次挥手.md" class="" aria-label="网络基础"><!--[--><!--]--> 网络基础 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/js_base_intensify/this指向/this到底指向谁.md" class="" aria-label="JavaScript 基础强化"><!--[--><!--]--> JavaScript 基础强化 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/interface/js/var let const.md" class="" aria-label="高频考点"><!--[--><!--]--> 高频考点 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/psychology/友情.md" class="" aria-label="没啥用的"><!--[--><!--]--> 没啥用的 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/front_road/road/前端路线.md" class="" aria-label="前端路线"><!--[--><!--]--> 前端路线 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/internet_base/internet/TCP三次握手和四次挥手.md" class="" aria-label="网络基础"><!--[--><!--]--> 网络基础 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/js_base_intensify/this指向/this到底指向谁.md" class="" aria-label="JavaScript 基础强化"><!--[--><!--]--> JavaScript 基础强化 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/interface/js/var let const.md" class="" aria-label="高频考点"><!--[--><!--]--> 高频考点 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/psychology/友情.md" class="" aria-label="没啥用的"><!--[--><!--]--> 没啥用的 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">internet <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/internet_base/internet/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="TCP三次握手和四次挥手"><!--[--><!--]--> TCP三次握手和四次挥手 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/internet_base/internet/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.html#tcp协议" class="router-link-active router-link-exact-active sidebar-item" aria-label="TCP协议"><!--[--><!--]--> TCP协议 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/internet_base/internet/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.html#传输层" class="router-link-active router-link-exact-active sidebar-item" aria-label="传输层"><!--[--><!--]--> 传输层 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/internet_base/internet/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.html#网络体系结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="网络体系结构"><!--[--><!--]--> 网络体系结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/internet_base/internet/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.html#三次握手-three-way-handshaking" class="router-link-active router-link-exact-active sidebar-item" aria-label="三次握手（three-way handshaking）"><!--[--><!--]--> 三次握手（three-way handshaking） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/internet_base/internet/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.html#四次挥手-four-way-wavehand" class="router-link-active router-link-exact-active sidebar-item" aria-label="四次挥手（Four-Way Wavehand）"><!--[--><!--]--> 四次挥手（Four-Way Wavehand） <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading">browser <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/internet_base/browser/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.html" class="sidebar-item" aria-label="浏览器工作原理"><!--[--><!--]--> 浏览器工作原理 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="tcp三次握手和四次挥手" tabindex="-1"><a class="header-anchor" href="#tcp三次握手和四次挥手" aria-hidden="true">#</a> TCP三次握手和四次挥手</h1><h3 id="tcp协议" tabindex="-1"><a class="header-anchor" href="#tcp协议" aria-hidden="true">#</a> TCP协议</h3><p>传输控制协议（TCP）是Internet一个重要的传输层协议。TCP提供面向连接、可靠、有序、字节流传输服务。应用程序在使用TCP之前，必须先建立TCP连接；TCP通过校验和、序列号、确认应答、重发控制、连接管理以及窗口控制等机制实现可靠性传输。</p><h3 id="传输层" tabindex="-1"><a class="header-anchor" href="#传输层" aria-hidden="true">#</a> 传输层</h3><p>传输层是整个网络体系结构中的关键层次之一，主要负责向两个主机中进程之间的通信提供服务。由于一个主机同时运行多个进程，因此运输层具有复用和分用功能。传输层在终端用户之间提供透明的数据传输，向上层提供可靠的数据传输服务。传输层在给定的链路上通过流量控制、分段/重组和差错控制来保证数据传输的可靠性。传输层的一些协议是面向链接的，这就意味着传输层能保持对分段的跟踪，并且重传那些失败的分段。</p><h3 id="网络体系结构" tabindex="-1"><a class="header-anchor" href="#网络体系结构" aria-hidden="true">#</a> 网络体系结构</h3><p>网络体系结构是指通信系统的整体设计，它为网络硬件、软件、协议、存取控制和拓扑提供标准。它广泛采用的是国际标准化组织（ISO）在1979年提出的开放系统互连（OSI-Open System Interconnection)的参考模型。</p><p><img src="/assets/网络体系结构层次.27f9e09f.png" alt="网络体系结构层次"></p><h3 id="三次握手-three-way-handshaking" tabindex="-1"><a class="header-anchor" href="#三次握手-three-way-handshaking" aria-hidden="true">#</a> 三次握手（three-way handshaking）</h3><p>三次握手是TCP协议为了确保数据能到达目标而采用的策略</p><p>重要字段</p><ul><li>seq：（sequence number）序号</li><li>ack：（acknowledgement number）确认号</li><li>标志位（flag）： <ul><li>SYN ：（synchronization）同步</li><li>ACK ：（acknowlegment）确认</li><li>FIN ：（finish）终止</li></ul></li></ul><p>发送端首先发送一个带 SYN 标志的数据包给对方。<br> 接收端收到后，回传一个带有 SYN/ACK 标志的数据包以示传达确认信息。<br> 最后，发送端再回传一个带 ACK 标志的数据包，代表“握手”结束。</p><p><img src="/assets/三次握手.679afef0.png" alt=""></p><p>为了防止接受重复的数据，TCP引入了一个机制，来识别是否已经接收到了这个数据，这个就是序列号；序列号是按顺序给发送数据的每一个字节（8位字节）都标上号码的编号，接收端查询接收数据TCP首部的序列号和数据的长度，来确认自己下一步应该接收的序号最为确认应答返送回去。</p><h3 id="四次挥手-four-way-wavehand" tabindex="-1"><a class="header-anchor" href="#四次挥手-four-way-wavehand" aria-hidden="true">#</a> 四次挥手（Four-Way Wavehand）</h3><p>所谓四次挥手（Four-Way Wavehand）即终止TCP连接，就是指断开一个TCP连接时，需要客户端和服务端相互总共发送4个包以确认连接的断开。在socket编程中，这一过程由客户端或服务端任一方执行close来触发。</p><p><img src="/assets/四次挥手.20b08e8f.png" alt=""></p><p>客户端首先发送一个带FIN标志的数据包到服务端，然后进入终止等待1状态<br> 服务端收到数据后，发送ACK包到客户端，然后进入等待关闭状态，客户端收到后进入终止等待2状态，此时服务端还可发送未发送数据，客户端还可接收数据<br> 服务端发送完数据后发送FIN包到客户端，进入最后确认状态<br> 客户端收到后发送ACK包，进入超时等待状态，超时后关闭连接，服务端接收后立即关闭</p><p>文章参考</p><p>《图解HTTP》<br> https://blog.csdn.net/qq_44647809/article/details/115143100 <br> https://baijiahao.baidu.com/s?id=1686533861418970902&amp;wfr=spider&amp;for=pc<br> https://www.bilibili.com/video/BV1kV411j7hA?spm_id_from=333.337.search-card.all.click</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 569552263@qq.com">徐泽</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.a46b8e12.js" defer></script>
  </body>
</html>
